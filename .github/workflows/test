name: OpenRouter Rankings Screenshot

on:
  workflow_dispatch:  # 只允许手动触发

jobs:
  screenshot:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          persist-credentials: true

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: Install Playwright
        run: |
          npm init -y
          npm install playwright
          npx playwright install chromium

      # 截取 https://openrouter.ai/rankings 页面截图
      - name: Take OpenRouter rankings screenshot
        run: |
          echo "const { chromium } = require('playwright');" > script_rankings.js
          echo "(async () => {" >> script_rankings.js
          echo "  const browser = await chromium.launch();" >> script_rankings.js
          echo "  const page = await browser.newPage({ viewport: { width: 1440, height: 900 } });" >> script_rankings.js
          echo "  await page.goto('https://openrouter.ai/rankings', { waitUntil: 'networkidle', timeout: 60000 });" >> script_rankings.js
          echo "  const showMore = page.locator('text=Show more');" >> script_rankings.js
          echo "  if (await showMore.count() > 0) {" >> script_rankings.js
          echo "    await showMore.first().click();" >> script_rankings.js
          echo "    await page.waitForTimeout(3000);" >> script_rankings.js
          echo "  }" >> script_rankings.js
          echo "  const rankingsSection = page.locator('main');" >> script_rankings.js
          echo "  await rankingsSection.waitFor({ timeout: 10000 });" >> script_rankings.js
          echo "  const date = new Date().toISOString().slice(0, 10);" >> script_rankings.js
          echo "  await rankingsSection.screenshot({ path: \`openrouter_ranking_\${date}.png\` });" >> script_rankings.js
          echo "  await browser.close();" >> script_rankings.js
          echo "})();" >> script_rankings.js
          node script_rankings.js

      # 截取 https://openrouter.ai/kwaipilot/kat-coder-pro:free/apps 页面截图
      - name: Take Kwaipilot Kat-Coder-Pro screenshot
        run: |
          echo "const { chromium } = require('playwright');" > script_kat_coder.js
          echo "(async () => {" >> script_kat_coder.js
          echo "  const browser = await chromium.launch();" >> script_kat_coder.js
          echo "  const page = await browser.newPage({ viewport: { width: 1440, height: 900 } });" >> script_kat_coder.js
          echo "  await page.goto('https://openrouter.ai/kwaipilot/kat-coder-pro:free/apps', { waitUntil: 'networkidle', timeout: 60000 });" >> script_kat_coder.js
          echo "  const showMore = page.locator('text=Show more');" >> script_kat_coder.js
          echo "  if (await sho
